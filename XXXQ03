-- XXXQ03 --

-- BEFORE -- 

SELECT *
	FROM IASQLTPROOF P, IASINVITEM I, IASMATBASIC B, IASCUSTOMER C 
	WHERE 1 = 2 
	INTO TPMQLTTABLE;

STARTDATE = START_DATE;
ENDDATE = END_DATE;

-- BUTTON -- 

SELECT I.VENDOR, C.NAME1 AS NAME1TT, I.INVDOCTYPE, I.QUNIT AS QUNIT1, SUM(I.QUANTITY) AS TOTALT 
	FROM IASQLTPROOF P, IASINVITEM I, IASCUSTOMER C
	WHERE P.CLIENT = YOUR_CLIENT_CODE
		AND P.COMPANY = YOUR_COMPANY_CODE
		AND I.COMPANY = P.COMPANY 
		AND I.CLIENT = P.CLIENT 
		AND I.COMPANY = C.COMPANY 
        AND I.CLIENT = C.CLIENT 
		AND P.INVDOCTYPE = I.INVDOCTYPE 
		AND P.INVDOCNUM = I.INVDOCNUM 
		AND P.INVDOCITEM = I.INVDOCITEM 
		AND I.ISCANCELED = 0 
		AND I.QPOSTWAY = 0
		AND I.DOCDATE >= STARTDATE
		AND I.DOCDATE <= ENDDATE
		AND I.VENDOR = C.CUSTOMER
	GROUPBY I.VENDOR, I.INVDOCTYPE, I.QUNIT, C.NAME1
	ORDERBY VENDOR 
	INTO TOTALTT;
	
-- BUTTON1 -- 

SELECT I.INVDOCTYPE AS INVDOCTYPEBT, I.QUNIT AS QUNIT2, SUM(I.QUANTITY) AS TOTALTB
	FROM IASQLTPROOF P, IASINVITEM I 
	WHERE P.CLIENT = SYS_CLIENT 
		AND P.COMPANY = SCOMP 
		AND I.COMPANY = P.COMPANY 
		AND I.CLIENT = P.CLIENT 
		AND  P.INVDOCTYPE = I.INVDOCTYPE 
		AND P.INVDOCNUM = I.INVDOCNUM 
		AND P.INVDOCITEM = I.INVDOCITEM 
		AND I.ISCANCELED = 0 
		AND I.QPOSTWAY = 0
		AND I.DOCDATE >= STARTDATE 
		AND I.DOCDATE <= ENDDATE 
	GROUPBY I.INVDOCTYPE, I.QUNIT
	ORDERBY I.INVDOCTYPE 
	INTO TOTALBT;
